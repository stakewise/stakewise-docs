---
title: 4. Prepare Operator
sidebar_position: 4
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Admonition from '@theme/Admonition';
import useBaseUrl from '@docusaurus/useBaseUrl';

# Prepare Operator

After installing the Operator Service, you need to generate **validator keystores** for your Vault. These keystores contain the cryptographic keys that your validators will use to sign attestations and propose blocks on the Ethereum network.

You will also need to create and upload a **deposit data file** to connect your node to the Vault, and set up a **hot wallet** for the Operator Service to handle validator registrations.

The Operator Service provides built-in functionality to generate all of the above.
Alternatively, you may use external tools such as [Wagyu Keygen ‚Üó](https://github.com/stake-house/wagyu-key-gen) to generate keystores, and existing wallets like [MetaMask ‚Üó](https://metamask.io/) or [MyEtherWallet ‚Üó](https://help.myetherwallet.com/en/articles/6512619-using-mew-offline) for the Operator wallet.

This section walks you through the validator key generation process using the Operator Service built-in tools.

<div style={{textAlign: 'center', margin: '2rem 0'}}>
  <pre style={{
    display: 'inline-block',
    textAlign: 'left',
    background: 'var(--ifm-color-emphasis-200)',
    color: 'var(--ifm-color-primary)',
    padding: '2rem',
    borderRadius: '12px',
    fontSize: '14px',
    fontFamily: 'Monaco, monospace',
    boxShadow: '0 10px 30px rgba(1,137,112,0.2)',
    lineHeight: '1.8'
  }}>
    <strong style={{fontSize: '16px', borderBottom: '2px solid #018970', paddingBottom: '0.5rem', display: 'inline-block', marginBottom: '1rem'}}>ü§ñ Prepare Operator</strong>

     üìù Initialize Mnemonic
       ‚Üì
     üîê Generate Validator Keys &rarr; üìÅ Keystores + üìÑ Deposit Data File
       ‚Üì
     ‚úÖ Import Keys to Consensus Client
       ‚Üì
     üíº Create Hot Wallet
       ‚Üì
     üì§ Upload Deposit Data File to Vault
       ‚Üì
     üöÄ Run Operator Service
  </pre>
</div>

## Step 1: Initialize Mnemonic

:::custom-notes[Initialize Configuration]
  Run the `init` command to set up your mnemonic used to derive your validator keys.
:::

For example, if running Operator Service from binary:

```bash
./operator init
```

Follow the command prompts.

<details className="custom-details">
<summary>Example Output</summary>
```
Enter the network name (mainnet, hoodi, gnosis, chiado) [mainnet]: hoodi
Enter your vault address: 0xf27...10ad9
Choose your mnemonic language (chinese_simplified, chinese_traditional, czech, english, italian, korean, portuguese, spanish) [english]: english

This is your seed phrase. Write it down and store it safely, it is the ONLY way to recover your validator keys.

where town man expand behind ...

Press any key when you have written down your mnemonic.

Please type your mnemonic (separated by spaces) to confirm you have written it down

: where town man expand behind ...

done.
Successfully initialized configuration for vault 0xf27...10ad9
```
</details>


:::custom-warning[Important Security Notice]
  Keep your mnemonic safe. It is the only way to recover your validator keys.
:::

## Step 2: Generate Validator Keys

Generate validator keystores from your mnemonic using:

```bash
./operator create-keys
```

Follow the command prompts.

<details className="custom-details">
<summary>Example Output</summary>
```
Enter the vault address: 0xf27...10ad9
Enter the number of the validator keys to generate: 3
Enter the mnemonic for generating the validator keys: where town man expand behind ...
Creating validator keys:		      [####################################]  3/3
Generating deposit data JSON		  [####################################]  3/3
Exporting validator keystores		  [####################################]  3/3
Done. Generated 3 keys for 0xf27...10ad9 vault.
Keystores saved to /Users/user/.stakewise/0xf27...10ad9/keystores file
Deposit data saved to /Users/user/.stakewise/0xf27...10ad9/deposit_data.json file
```
</details>

This command generates the following files in your Vault directory (`~/.stakewise/[vault address]/`):

1. `config.json` - Configuration file for your Vault.
2. `deposit_data.json` - Contains validator registration information including public keys, withdrawal credentials, and cryptographic signatures. This file must be uploaded to your Vault ([Step 5: Upload Deposit Data File ‚Üí](./prepare-operator#step-5-upload-deposit-data-file-to-vault)) to authorize the Operator Service to register your validators.
3. `keystores/` directory containing: validator keystores and `password.txt` for all generated keystores.

:::custom-notes[Note]
  - **Per-keystore option**: Use the `--per-keystore-password` flag to generate individual password files for each keystore (e.g., `keystore-001.txt`, `keystore-002.txt`, etc.)
:::

:::custom-warning[Important]
  Protect your password files as carefully as your keystores ‚Äî anyone with access to them can decrypt your keys. This applies to both the single `password.txt` file and individual per-keystore password files.
:::

### Add Validator Keys to Vault

You can always add more validator keys to your Vault:

1. Generate new validator keys and deposit data as described in this step
2. Upload the deposit data file to your Vault as described in [Step 5: Upload Deposit Data File ‚Üí](./prepare-operator#step-5-upload-deposit-data-file-to-vault)

:::custom-warning[Important]
Uploading a new deposit data file will overwrite the existing file and consequently overwrite previously unused validator keys.
This can be done at any point, but only by the Vault Admin or Keys Manager.
:::

### Alternative Key Management

Validator keystores don't need to be stored locally. You can instead use:

- **[Remote Signer ‚Üí](./alternative-key-management/remote-signer)** ‚Äî Sign deposit/exit messages via a remote signer
- **[HashiCorp Vault ‚Üí](./alternative-key-management/hashicorp-vault)** ‚Äî Load keys from a remote Vault instance
- **[API Mode ‚Üí](./alternative-key-management/api-mode)** ‚Äî Run Operator as API service with external key management

## Step 3: Import Validator Keys

Upload your keystores into your validator client:

1. Locate your keystores in `~/.stakewise/[vault address]/keystores`
2. Follow your consensus client's guide for importing keys
3. Use the password from `password.txt` file
4. Start the validator client with attached validator keys.

## Step 4: Create Hot Wallet

Run the `create-wallet` command to create your hot wallet using your mnemonic.

:::custom-notes[Note]
This mnemonic can be the same as the one used to generate the validator keys, or a new mnemonic if you desire.
:::

```bash
./operator create-wallet
```

<details className="custom-details">
<summary>Example Output</summary>
```
Enter the vault address: 0xf27...10ad9
Enter the mnemonic for generating the wallet: where town man expand behind ...
Done. The wallet and password saved to /Users/user/.stakewise/0xf27...10ad9/wallet directory. The wallet address is: 0x9A739D3...E4921685
```
</details>

:::custom-warning[Wallet Balance Warning]
  Fund your wallet with ETH (or xDAI on Gnosis) to cover gas:

    - Each validator registration costs ~0.01 ETH at 30 Gwei gas price
    - Check current gas prices at [Etherscan Gas Tracker ‚Üó](https://etherscan.io/gastracker)
    - Monitor balance regularly to prevent registration failures
:::

## Step 5: Upload Deposit Data File to Vault

Once you have created your validator keys, deposit data file, and hot wallet, you need to upload the deposit data file to the Vault to allow the Operator Service to register validators on your behalf.

:::custom-notes[Multiple Operators]
If your Vault has multiple node operators, you must first merge all operator deposit data files into a single file using the `merge-deposit-data` command before uploading.
:::

The deposit data file can be uploaded through the StakeWise UI or via the Operator Service. Only the **Vault Admin** or **Keys Manager** can perform this action.

<Tabs>
<TabItem value="ui" label="StakeWise UI">

1. Connect your wallet and navigate to the [Operate page ‚Üó](https://app.stakewise.io/operate)
2. Select your Vault from the list
3. Click **Settings** in the upper right corner and open the **Deposit Data** tab
4. Upload your deposit data file by dragging and dropping it, or clicking to browse your files
5. Click **Save** and confirm the transaction in your wallet

The deposit data file will be uploaded once the transaction is confirmed on the network.

</TabItem>
<TabItem value="operator" label="Operator Service">

If you cannot use the UI, you can upload the deposit data using the Operator Service.

First, calculate the Merkle tree root of your deposit data:

```bash
./operator get-validators-root
```

```bash
Enter the vault address: 0xf27...10ad9
The validator deposit data Merkle tree root: 0x6048426ae17705a90603d7a544378bc5eb0a4ae80bb23543e0e48b323081f2b8
```

Next, find your Vault version by calling the `version` method on your Vault contract.

For Vault version 1:
  - Call the `setValidatorsRoot` method on your Vault contract

For Vault version 2 or higher:
  - Call the `setDepositDataRoot` method on the `DepositDataRegistry` contract

:::custom-notes[Contract Addresses]
`DepositDataRegistry` contracts:
  - Ethereum: https://etherscan.io/address/0x75AB6DdCe07556639333d3Df1eaa684F5735223e
  - Gnosis: https://gnosisscan.io/address/0x58e16621B5c0786D6667D2d54E28A20940269E16

You can interact with these contracts via Etherscan or CLI tools like [eth-cli ‚Üó](https://github.com/protofire/eth-cli). The ABI is available [here ‚Üó](https://github.com/stakewise/v3-core/blob/v3.0.0/abi/IDepositDataRegistry.json).
:::

Steps via Etherscan:

1. Navigate to the `DepositDataRegistry` contract address for your network
2. Select the **Contract** tab, then **Write Contract**
3. Connect your wallet (must be Vault Admin or Keys Manager)
4. Find the `setDepositDataRoot` function
5. Enter your Vault address and the Merkle tree root from the command above
6. Click **Write** and confirm the transaction
</TabItem>
</Tabs>

## Next Steps

üéâ Your Operator Service is now set up! Continue to [Start Operator ‚Üí](start-operator) to launch your Operator Service.
